<process name="NAB.FirstHomeLoanDepositScheme.ReserveApplication" version="1.0" bpversion="6.4.2.10610" narrative="This process reserves the applications for customers on the NHFIC FHLDS portal." byrefcollection="true" preferredid="ae9ccf84-5572-493d-9cc0-d01797200767">
  <view>
    <camerax>330</camerax>
    <cameray>63</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <stage stageid="f12e3e2a-8654-459e-bf42-8e52a3dc632a" name="Start" type="Start">
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-180</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>b4d501f9-fd2c-455b-be4b-9ba9ef6049a1</onsuccess>
  </stage>
  <stage stageid="c79034f5-db66-47e1-8ce3-ad958d6e81c0" name="End" type="End">
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>300</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="2e9e1902-aac5-4516-8cf0-a6a7d78f9b13" name="Stage1" type="ProcessInfo">
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="b49c8d5b-a769-47c6-8c03-664f9c5dd3d7" name="GetNextWorkItem" type="Action">
    <narrative>Get the work item available in the item queue for processing.</narrative>
    <displayx>15</displayx>
    <displayy>60</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue" expr="[env_Txt_FHLDS_QueueName]" />
      <input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" />
      <input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="txtQueueItemID" />
      <output type="collection" name="Data" narrative="The data associated with the item - a single collection row." stage="QueueItemData" />
      <output type="text" name="Status" narrative="The status of the item." stage="txtQueueItemStatus" />
      <output type="number" name="Attempts" narrative="The number of attempts already made to work this item." stage="numQueueItemAttempts" />
    </outputs>
    <onsuccess>827567c8-dab9-40c8-85bc-2d819d68e106</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" />
  </stage>
  <stage stageid="67325edb-baf7-46b0-bfd3-437839cf0f65" name="env_Txt_FHLDS_QueueName" type="Data">
    <narrative>
    </narrative>
    <displayx>-435</displayx>
    <displayy>0</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3d98614a-0657-4313-8b6c-6c37c81907d4" name="numQueueItemAttempts" type="Data">
    <narrative>
    </narrative>
    <displayx>-510</displayx>
    <displayy>210</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b9b99e1d-756c-427a-98bc-c4b928aeab84" name="txtQueueItemStatus" type="Data">
    <narrative>
    </narrative>
    <displayx>-375</displayx>
    <displayy>135</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="07129161-c76e-4b66-8ef7-683770d93beb" name="txtQueueItemID" type="Data">
    <narrative>
    </narrative>
    <displayx>-495</displayx>
    <displayy>135</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="91323c55-f276-4d5d-9346-eba3b9e49b2a" name="QueueItemData" type="Collection">
    <narrative>
    </narrative>
    <displayx>-450</displayx>
    <displayy>75</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="HasTwoBuyers" type="text" />
      <field name="Buyer1_Title" type="text" />
      <field name="Buyer1_FirstName" type="text" />
      <field name="Buyer1_MiddleName" type="text" />
      <field name="Buyer1_FamilyName" type="text" />
      <field name="Buyer1_DateOfBirth" type="datetime" />
      <field name="Buyer1_MedicareNumber" type="number" />
      <field name="Buyer1_MedicarePositionNumber" type="number" />
      <field name="Buyer2_Title" type="text" />
      <field name="Buyer2_FirstName" type="text" />
      <field name="Buyer2_MiddleName" type="text" />
      <field name="Buyer2_FamilyName" type="text" />
      <field name="Buyer2_DateOfBirth" type="datetime" />
      <field name="Buyer2_MedicareNumber" type="number" />
      <field name="Buyer2_MedicarePositionNumber" type="number" />
      <field name="FileRowNumber" type="number" />
      <field name="QueueItemKey" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="622fff94-0763-48c5-8f2d-5698aadbe379" name="QueueItemReferenceData" type="Collection">
    <narrative>
    </narrative>
    <displayx>-300</displayx>
    <displayy>75</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="FileRowNumber" type="number" />
      <field name="QueueItemKey" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="cb6f9359-2679-4f97-a7b7-2a9eb51fe25e" name="StoreDataInQueueItem?" type="Decision">
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-15</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="[env_Flg_FHLDS_StoreAllData]" />
    <ontrue>b49c8d5b-a769-47c6-8c03-664f9c5dd3d7</ontrue>
    <onfalse>e53b8da4-db9e-4c25-90e6-404cb30ce3cd</onfalse>
  </stage>
  <stage stageid="9b96bf95-c0f6-42c2-abc4-2fe708631d76" name="env_Flg_FHLDS_StoreAllData" type="Data">
    <narrative>
    </narrative>
    <displayx>-285</displayx>
    <displayy>0</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e53b8da4-db9e-4c25-90e6-404cb30ce3cd" name="GetNextWorkItem" type="Action">
    <narrative>Get the work item available in the item queue for processing.</narrative>
    <displayx>180</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue" expr="[env_Txt_FHLDS_QueueName]" />
      <input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" />
      <input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="txtQueueItemID" />
      <output type="collection" name="Data" narrative="The data associated with the item - a single collection row." stage="QueueItemReferenceData" />
      <output type="text" name="Status" narrative="The status of the item." stage="txtQueueItemStatus" />
      <output type="number" name="Attempts" narrative="The number of attempts already made to work this item." stage="numQueueItemAttempts" />
    </outputs>
    <onsuccess>6d77a66c-f10e-47e1-9cce-24e4cf2898d0</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" />
  </stage>
  <stage stageid="6d77a66c-f10e-47e1-9cce-24e4cf2898d0" name="End1" type="End">
    <narrative>
    </narrative>
    <displayx>315</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="827567c8-dab9-40c8-85bc-2d819d68e106" name="IsApplicationLaunched?" type="Decision">
    <narrative>Check if the eBOBS application is launched previously.</narrative>
    <displayx>15</displayx>
    <displayy>135</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="[flgApplicationLaunched]" />
    <ontrue>5bd69e36-7567-46a2-8ef0-9a4666c3e39d</ontrue>
    <onfalse>86a3999e-f3c2-4bb8-a322-59052ff01138</onfalse>
  </stage>
  <stage stageid="df534418-84d9-41df-89f3-60dc69918dbe" name="flgApplicationLaunched" type="Data">
    <narrative>
    </narrative>
    <displayx>-360</displayx>
    <displayy>210</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b4d501f9-fd2c-455b-be4b-9ba9ef6049a1" name="InitializeVariables" type="MultipleCalculation">
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>cb6f9359-2679-4f97-a7b7-2a9eb51fe25e</onsuccess>
    <steps>
      <calculation expression="False" stage="flgApplicationLaunched" />
    </steps>
  </stage>
  <stage stageid="5bd69e36-7567-46a2-8ef0-9a4666c3e39d" name="SetLaunchFlagToTrue" type="Calculation">
    <narrative>Set the flag to indicate that the eBOBS application has been launched.</narrative>
    <displayx>15</displayx>
    <displayy>240</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>c79034f5-db66-47e1-8ce3-ad958d6e81c0</onsuccess>
    <calculation expression="True" stage="flgApplicationLaunched" />
  </stage>
  <stage stageid="86a3999e-f3c2-4bb8-a322-59052ff01138" name="ResetRetryCounter" type="Calculation">
    <narrative>Reset the retry counter</narrative>
    <displayx>195</displayx>
    <displayy>135</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>8f53d13d-a501-4452-aaf7-2b29a224b53b</onsuccess>
    <calculation expression="0" stage="numRetryCount" />
  </stage>
  <stage stageid="4eb4f15c-2f2f-4be8-90fe-2a7eaadb0fa2" name="numRetryCount" type="Data">
    <narrative>
    </narrative>
    <displayx>-555</displayx>
    <displayy>255</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8f53d13d-a501-4452-aaf7-2b29a224b53b" name="LaunchPortal" type="Action">
    <narrative>
    </narrative>
    <displayx>330</displayx>
    <displayy>135</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>73da6559-9b7a-4cc2-b6b1-a72e334ff29e</onsuccess>
    <resource object="NAB.FirstHomeLoanDepositScheme.FHLDSPortal" action="Launch" />
  </stage>
  <stage stageid="ae556516-1d46-4430-ad4a-c2730edfa127" name="Local-Recover-LaunchApplicationException" type="Recover">
    <narrative>
    </narrative>
    <displayx>495</displayx>
    <displayy>135</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>ffca0b2a-72ed-4716-94df-75528a0c6af7</onsuccess>
  </stage>
  <stage stageid="87e2db8b-6a57-4256-b33c-4852ee922992" name="Local-Resume-LaunchApplicationExceptionResume" type="Resume">
    <narrative>
    </narrative>
    <displayx>1020</displayx>
    <displayy>135</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>14cd438a-db00-4826-bd62-62d2ec048a1b</onsuccess>
  </stage>
  <stage stageid="ffca0b2a-72ed-4716-94df-75528a0c6af7" name="SetSystemExceptionDetails" type="MultipleCalculation">
    <narrative>
    </narrative>
    <displayx>720</displayx>
    <displayy>135</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>87e2db8b-6a57-4256-b33c-4852ee922992</onsuccess>
    <steps>
      <calculation expression="&quot;Exception Encountered&quot;" stage="txtExceptionTag" />
      <calculation expression="ExceptionType()" stage="txtExceptionType" />
      <calculation expression="ExceptionDetail()" stage="txtExceptionDetail" />
    </steps>
  </stage>
  <stage stageid="22799795-d5ed-4ad0-a85e-e1e04354b85b" name="LaunchTargetApplication" type="Block">
    <narrative>
    </narrative>
    <displayx>285</displayx>
    <displayy>90</displayy>
    <displaywidth>585</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="aea7c9a7-07e3-4ed8-b9b6-e11fa8fb3b62" name="txtExceptionType" type="Data">
    <narrative>
    </narrative>
    <displayx>-480</displayx>
    <displayy>315</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2fc4272a-5d17-4069-8947-612cdb59bd5d" name="txtExceptionTag" type="Data">
    <narrative>
    </narrative>
    <displayx>-390</displayx>
    <displayy>270</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="82c52f41-3100-48f3-add0-7cd9a47739fe" name="txtExceptionDetail" type="Data">
    <narrative>
    </narrative>
    <displayx>-315</displayx>
    <displayy>315</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="14cd438a-db00-4826-bd62-62d2ec048a1b" name="Retry?" type="Decision">
    <narrative>Check if the application launch should be tried again.</narrative>
    <displayx>1185</displayx>
    <displayy>135</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="[numRetryCount]&lt;[numRetryLimit]" />
    <ontrue>5d5a197f-7fc9-4a75-96b1-48b2bbfd2a88</ontrue>
  </stage>
  <stage stageid="5d5a197f-7fc9-4a75-96b1-48b2bbfd2a88" name="Increment" type="Calculation">
    <narrative>Increment the Retry counter.</narrative>
    <displayx>1185</displayx>
    <displayy>30</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>32c40fe4-eafd-4b1e-a139-8e0bfcc0d0e7</onsuccess>
    <calculation expression="[numRetryCount]+1" stage="numRetryCount" />
  </stage>
  <stage stageid="32c40fe4-eafd-4b1e-a139-8e0bfcc0d0e7" name="Anchor1" type="Anchor">
    <narrative>
    </narrative>
    <displayx>330</displayx>
    <displayy>30</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>8f53d13d-a501-4452-aaf7-2b29a224b53b</onsuccess>
  </stage>
  <stage stageid="15a0d1d2-2ae2-4b24-96be-47f19bb5b462" name="numRetryLimit" type="Data">
    <narrative>
    </narrative>
    <displayx>-510</displayx>
    <displayy>390</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue>3</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="73da6559-9b7a-4cc2-b6b1-a72e334ff29e" name="LoginToPortal" type="Action">
    <narrative>
    </narrative>
    <displayx>330</displayx>
    <displayy>240</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>5bd69e36-7567-46a2-8ef0-9a4666c3e39d</onsuccess>
    <resource object="NAB.FirstHomeLoanDepositScheme.FHLDSPortal" action="Login" />
  </stage>
</process>